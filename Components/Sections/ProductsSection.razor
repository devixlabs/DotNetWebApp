@using DotNetWebApp.Components.Pages

<RadzenCard>
    <RadzenStack Gap="16px">
        <RadzenStack Orientation="@Orientation.Horizontal" AlignItems="@AlignItems.Center" JustifyContent="@JustifyContent.SpaceBetween">
            <RadzenText Text="Products Management" TextStyle="TextStyle.Subtitle2" />
            <RadzenStack Orientation="@Orientation.Horizontal" AlignItems="@AlignItems.Center" Gap="8px">
                <RadzenButton Click="OnRefresh" IsBusy="@IsLoading" Text="@(IsLoading ? "Loading..." : "Refresh")"
                              Icon="refresh" ButtonStyle="ButtonStyle.Primary" />
                <RadzenButton Click="AddNewProduct" Text="Add Product" Icon="add"
                              ButtonStyle="ButtonStyle.Success" />
            </RadzenStack>
        </RadzenStack>

        @if (Products == null || Products.Count == 0)
        {
            @if (IsLoading)
            {
                <RadzenStack Gap="12px" AlignItems="@AlignItems.Center">
                    <RadzenProgressBar ProgressBarStyle="ProgressBarStyle.Primary" Value="100" ShowValue="false" Mode="ProgressBarMode.Indeterminate" />
                    <RadzenText Text="Loading products..." TextStyle="TextStyle.Body2" />
                </RadzenStack>
            }
            else
            {
                <RadzenStack Gap="12px" AlignItems="@AlignItems.Center">
                    <RadzenText Text="No products found." TextStyle="TextStyle.Body2" />
                    <RadzenButton Click="OnRefresh" Text="Load Products" ButtonStyle="ButtonStyle.Primary" />
                </RadzenStack>
            }
        }
        else
        {
            <RadzenDataGrid AllowFiltering="true" AllowColumnResize="true" AllowSorting="true" PageSize="5" AllowPaging="true"
                           ShowPagingSummary="true" Data="@Products" TItem="Product" ColumnWidth="200px">
                <Columns>
                    <RadzenDataGridColumn TItem="Product" Property="Id" Title="ID" Width="80px" />
                    <RadzenDataGridColumn TItem="Product" Property="Name" Title="Product Name" />
                    <RadzenDataGridColumn TItem="Product" Property="Price" Title="Price" FormatString="{0:C}">
                        <Template Context="product">
                            <RadzenText Text="@($"{product.Price:C}")" TextStyle="TextStyle.Body1" />
                        </Template>
                    </RadzenDataGridColumn>
                    <RadzenDataGridColumn TItem="Product" Context="product" Filterable="false" Sortable="false" TextAlign="TextAlign.Right" Width="200px">
                        <Template Context="product">
                            <RadzenStack Orientation="@Orientation.Horizontal" AlignItems="@AlignItems.Center" Gap="6px">
                                <RadzenButton ButtonStyle="ButtonStyle.Light" Icon="edit" Click="@(args => EditProduct(product.Id))" />
                                <RadzenButton ButtonStyle="ButtonStyle.Danger" Icon="delete" Click="@(args => DeleteProduct(product.Id))" />
                            </RadzenStack>
                        </Template>
                        <HeaderTemplate>
                            <span>Actions</span>
                        </HeaderTemplate>
                    </RadzenDataGridColumn>
                </Columns>
            </RadzenDataGrid>
        }
    </RadzenStack>
</RadzenCard>

@code {
    [Parameter] public IReadOnlyList<Product>? Products { get; set; }
    [Parameter] public bool IsLoading { get; set; }
    [Parameter] public EventCallback OnRefresh { get; set; }

    private async Task AddNewProduct()
    {
        // In a real app, this would open a modal or navigate to an add form
        await Task.Delay(100); // Placeholder
        Console.WriteLine("Add new product clicked");
    }

    private async Task EditProduct(int productId)
    {
        // In a real app, this would open edit modal or form
        await Task.Delay(100); // Placeholder
        Console.WriteLine($"Edit product {productId} clicked");
    }

    private async Task DeleteProduct(int productId)
    {
        // In a real app, this would show confirmation and delete
        await Task.Delay(100); // Placeholder
        Console.WriteLine($"Delete product {productId} clicked");
    }
}
